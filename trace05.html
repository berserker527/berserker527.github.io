<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
		<meta name="apple-mobile-web-app-capable" content="yes"/>
		<meta name="apple-mobile-web-app-status-bar-style" content="black"/>
		<meta name="format-detection" content="telephone=no"/>
		<title>歌尾倾泪_第五章</title>
		<script type="text/javascript" src="js/jquery-1.7.2.js"></script>
		<script type="text/javascript" src="js/jquery.swipe.js"></script>
		<style type="text/css">
			*{
				margin:0;
				padding:0;
				-moz-user-select: none;
				-webkit-user-select: none;
				font-family:"MicroSoft YaHei";
				font-size:16px;
			}	
			.fl{
				float:left;
			}
			.fr{
				float:right;
			}
			.title{
				color:#464646;
			}
			.title-disk{
				float:left;
				display:none;
			}
			.title-trace{
				font-size:20px;
				font-weight:bold;
				text-align:center;
				margin:20px auto;
			}
			.title-trace-mini{
				float:right;
				font-size:12px;
			}
			.context{
				font-size:16px;
				width:100%;
				margin:0px auto;
				color:#464646;
			}
			.pager{
				width:100%;
				margin:20px auto;
			}
			.pageNum{
				float:left;
				width:24px;
				height:24px;
				line-height:24px;
				text-align:center;
				font-size:16px;
				border:1px solid #e0e0e0;
				margin:0px 3px;
				color:#039bf2;
				cursor:pointer;
			}
			.pageNum:hover{
				background:#e0e0e0;
				color:#f9bc16;
			}
			.current{
				float:left;
				width:24px;
				height:24px;
				line-height:24px;
				text-align:center;
				font-size:16px;
				border:1px solid #fff;
				color:#f9bc16;
				margin:0px 3px;
			}
			p{
				text-indent:2em;
				margin:5px 5%;
				line-height:160%;
				letter-spacing:0.1em;
			}
			.top{
				position:fixed;
				top:0px;
				width:100%;
				height:0%;
				margin:0 auto;
				background:#414141;
				filter:alpha(opacity = 80); 
				opacity:0.8
			}
			
			.right{
				float:left;
				margin-bottom:200px;
			}
			.help{
				width:100%;
				height:50px;
				line-height:50px;
				position:fixed;
				bottom:0px;
				font-family:"MicroSoft YaHei";
				text-align:center;
				font-size:16px;
				border-top:1px solid #c1c1c1;
				background:#fff;
				color:#3e3e3e;
				z-index:11;
			}
			@media screen and (max-width:480px){
				.right{
					background:#ddccaa;
				}
				.help{
					-webkit-box-shadow:-5px 0 5px #ccc;  
					-moz-box-shadow:-5px 0 5px #ccc;  
					box-shadow:-5px 0 5px #ccc;
				}
				.footer li{
					cursor:pointer;
				}
				.menu{
					width:50px;
					border-right:1px solid #c1c1c1;
				}
				.refresh{
					width:50px;
					border-left:1px solid #c1c1c1;
				}
				.info{
					width:50px;
					border-left:1px solid #c1c1c1;
					border-right:1px solid #c1c1c1;
				}
				.goto{
					width:auto;
				}
				li{
					list-style:none;
				}
				.disk{
					width:130px;
					display:none;
					position:fixed;
					bottom:50px;
					border-top:1px solid #c1c1c1;
					border-right:1px solid #c1c1c1;
					background:#fff;
					z-index:10;
				}
				.disk li{
					height:50px;
					line-height:50px;
					color:#3e3e3e;
					border-bottom:1px solid #c1c1c1;
					text-align:center;
				}
				.trace{
					width:220px;
					display:none;
					position:fixed;
					bottom:50px;
					left:130px;
					border:1px solid #c1c1c1;
					border-bottom:none;
					background:#fff;
					z-index:10;
				}
				.trace li{
					height:50px;
					line-height:50px;
					color:#3e3e3e;
					border-bottom:1px solid #c1c1c1;
					text-align:center;
				}
			}
		</style>
	</head>
	<body>
		<div class="top"></div>
		<div class="right" id="right">
			<div class="title">
				<div class="title-disk fr">Disk 1 苏醒的梦</div>
				<div class="title-trace">Track 5 混乱的狂想曲</div>
			</div>
			
			<div class="context">
				正在加载，请稍等......
			</div>
			<div class="pager"></div>
		</div>
	</body>
</html>
<script type="text/javascript">
$(function (){
	var sectionCount;
	var pageCount;
	var currentPage = 0;
	function initPager(){
		$.ajax({
          type: "GET",
          url: "trace05.txt",
          success: function(data){
		  	sectionCount = data.split("<br/>").length;
			pageCount = (sectionCount - 1) / 5;
			
			for (var i = 0; i < pageCount; i++) {
				if(i == 0){
					$(".pager").append('<div class="pageNum current" index="' + i + '">' + (i + 1) + '</div>');
				}
				else{
					$(".pager").append('<div class="pageNum" index="' + i + '">' + (i + 1) + '</div>');
				}
			};
			
			
			$(".pageNum").click(function(){
				$(".pageNum").removeClass("current");
				$(this).addClass("current");
				var index = $(this).attr("index");
				showContext(index);
				window.document.body.scrollTop = 0;
			});
          }
        });
	}
	
	function showContext(currentPage){
		$.ajax({
          type: "GET",
          url: "trace05.txt",
          success: function(data){
			data = data.split("<br/>");
			
			$(".context").html("");
			for (var i = 0; i < 5; i++) {
				if(5 * currentPage + i < sectionCount){
					$(".context").append(data[5 * currentPage + i] + "<br/>")
				}
				else{
					break;
				}
			};
          }
        });  
	}
	  
	initPager();
	showContext(0);
	
});

$(function(){
	$.ajax({
      type : "GET",
      url : "title",
	  dateTypy : "html",
      success : function(data){
		$(".right").after(data);
      }
	});
	
	$(".right").swipe(function(){
		
	});
});
</script>